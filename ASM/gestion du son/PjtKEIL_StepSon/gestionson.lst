


ARM Macro Assembler    Page 1 


    1 00000000                 PRESERVE8
    2 00000000                 THUMB
    3 00000000         
    4 00000000         ; ====================== zone de réservation de données,
                         ======================================
    5 00000000         ;Section RAM (read only) :
    6 00000000                 area             mesdata,data,readonly
    7 00000000                 import           LongueurSon
    8 00000000                 import           Son
    9 00000000         
   10 00000000         ;Section RAM (read write):
   11 00000000                 area             maram,data,readwrite
   12 00000000 00000000 
                       IndexTable
                               dcd              0           ;
   13 00000004                 export           IndexTable
   14 00000004 00 00   SortieSon
                               dcw              0           ;
   15 00000006                 export           SortieSon
   16 00000006         
   17 00000006         
   18 00000006         ; ======================================================
                       =========================================
   19 00000006         
   20 00000006         
   21 00000006                 export           CallbackSon
   22 00000006         
   23 00000006                 export           StartSon
   24 00000006         
   25 00000006         ;Section ROM code (read only) :  
   26 00000006                 area             moncode,code,readonly
   27 00000000         
   28 00000000                 import           PWM_Set_Value_TIM3_Ch3
   29 00000000         ; écrire le code ici
   30 00000000         
   31 00000000         
   32 00000000         StartSon
                               proc
   33 00000000 481E            ldr              R0,=IndexTable
   34 00000002 F04F 0100       mov              R1, #0
   35 00000006 6001            str              R1, [r0]
   36 00000008 4770            bx               lr
   37 0000000A                 endp
   38 0000000A         
   39 0000000A         
   40 0000000A         CallbackSon
                               proc
   41 0000000A B500            push             {lr}
   42 0000000C 481B            ldr              R0, =IndexTable
   43 0000000E 8800            ldrh             R0, [R0]
   44 00000010 4601            mov              R1, R0
   45 00000012 4B1B            ldr              R3, =LongueurSon
   46 00000014 681B            ldr              R3, [R3]
   47 00000016 EBA1 0103       sub              R1, R3
   48 0000001A 2900            cmp              R1, #0
   49 0000001C D01D            beq              sinon
   50 0000001E         alors
   51 0000001E F04F 0302       mov              R3, #2
   52 00000022 FB00 F003       mul              R0, R3



ARM Macro Assembler    Page 2 


   53 00000026 4917            ldr              R1, =Son
   54 00000028 5E0A            ldrsh            R2, [R1, R0]
   55 0000002A         ; maintenent il faut recentrer le son entre [0,719], son
                       _recentree = (son+32768)/ (65535/719) ;
   56 0000002A         ; on prendra son_recentree = ( son + 32768 )*719 / 65536
                        => max à 718,98 ;
   57 0000002A F502 4200       add              R2, #32768
   58 0000002E F240 23CF       mov              R3, #719
   59 00000032 FB02 F203       mul              R2, R3
   60 00000036 F44F 3380       mov              R3, #65536
   61 0000003A FB92 F2F3       sdiv             R2, R3
   62 0000003E 4B12            ldr              R3, =SortieSon
   63 00000040 801A            strh             R2, [R3]
   64 00000042         
   65 00000042         ;PWM_Set_Value_TIM3_Ch3(SortieSon);
   66 00000042 B401            push{R0}
   67 00000044 4610            mov              R0, R2
   68 00000046 F7FF FFFE       bl               PWM_Set_Value_TIM3_Ch3
   69 0000004A BC01            pop{R0}
   70 0000004C         
   71 0000004C 480B            ldr              R0, =IndexTable
   72 0000004E 8801            ldrh             R1, [R0]
   73 00000050 F101 0101       add              R1, #1
   74 00000054 6001            str              R1, [R0]
   75 00000056 F000 F80D       bl               fin
   76 0000005A         sinon
   77 0000005A F44F 72B4       mov              R2, #360
   78 0000005E 4B0A            ldr              R3, =SortieSon
   79 00000060 801A            strh             R2, [R3]
   80 00000062         
   81 00000062         ;PWM_Set_Value_TIM3_Ch3(SortieSon);
   82 00000062 B401            push{R0}
   83 00000064 4610            mov              R0, R2
   84 00000066 F7FF FFFE       bl               PWM_Set_Value_TIM3_Ch3
   85 0000006A BC01            pop{R0}
   86 0000006C         
   87 0000006C         ;on lance StartSon pour relancer le son en boucle;
   88 0000006C B403            push{R0,R1}
   89 0000006E F7FF FFFE       bl               StartSon
   90 00000072 BC03            pop{R0,R1}
   91 00000074         fin
   92 00000074         
   93 00000074 F85D EB04       pop              {lr}
   94 00000078 4770            bx               lr
   95 0000007A                 endp
   96 0000007A         
   97 0000007A                 END
              00 00 00000000 
              00000000 
              00000000 
              00000000 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M3 --apcs=interw
ork --depend=.\obj\gestionson.d -o.\obj\gestionson.o -I.\RTE\_Simu -IC:\Program
data\Keil\Arm\Packs\ARM\CMSIS\5.7.0\CMSIS\Core\Include -IC:\Programdata\Keil\Ar
m\Packs\Keil\STM32F1xx_DFP\2.3.0\Device\Include --predefine="__EVAL SETA 1" --p
redefine="__MICROLIB SETA 1" --predefine="__UVISION_VERSION SETA 530" --predefi
ne="_RTE_ SETA 1" --predefine="STM32F10X_MD SETA 1" --predefine="_RTE_ SETA 1" 
--list=gestionson.lst Src\GestionSon.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

mesdata 00000000

Symbol: mesdata
   Definitions
      At line 6 in file Src\GestionSon.s
   Uses
      None
Comment: mesdata unused
1 symbol



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

IndexTable 00000000

Symbol: IndexTable
   Definitions
      At line 12 in file Src\GestionSon.s
   Uses
      At line 13 in file Src\GestionSon.s
      At line 33 in file Src\GestionSon.s
      At line 42 in file Src\GestionSon.s
      At line 71 in file Src\GestionSon.s

SortieSon 00000004

Symbol: SortieSon
   Definitions
      At line 14 in file Src\GestionSon.s
   Uses
      At line 15 in file Src\GestionSon.s
      At line 62 in file Src\GestionSon.s
      At line 78 in file Src\GestionSon.s

maram 00000000

Symbol: maram
   Definitions
      At line 11 in file Src\GestionSon.s
   Uses
      None
Comment: maram unused
3 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

CallbackSon 0000000A

Symbol: CallbackSon
   Definitions
      At line 40 in file Src\GestionSon.s
   Uses
      At line 21 in file Src\GestionSon.s
Comment: CallbackSon used once
StartSon 00000000

Symbol: StartSon
   Definitions
      At line 32 in file Src\GestionSon.s
   Uses
      At line 23 in file Src\GestionSon.s
      At line 89 in file Src\GestionSon.s

alors 0000001E

Symbol: alors
   Definitions
      At line 50 in file Src\GestionSon.s
   Uses
      None
Comment: alors unused
fin 00000074

Symbol: fin
   Definitions
      At line 91 in file Src\GestionSon.s
   Uses
      At line 75 in file Src\GestionSon.s
Comment: fin used once
moncode 00000000

Symbol: moncode
   Definitions
      At line 26 in file Src\GestionSon.s
   Uses
      None
Comment: moncode unused
sinon 0000005A

Symbol: sinon
   Definitions
      At line 76 in file Src\GestionSon.s
   Uses
      At line 49 in file Src\GestionSon.s
Comment: sinon used once
6 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

LongueurSon 00000000

Symbol: LongueurSon
   Definitions
      At line 7 in file Src\GestionSon.s
   Uses
      At line 45 in file Src\GestionSon.s
Comment: LongueurSon used once
PWM_Set_Value_TIM3_Ch3 00000000

Symbol: PWM_Set_Value_TIM3_Ch3
   Definitions
      At line 28 in file Src\GestionSon.s
   Uses
      At line 68 in file Src\GestionSon.s
      At line 84 in file Src\GestionSon.s

Son 00000000

Symbol: Son
   Definitions
      At line 8 in file Src\GestionSon.s
   Uses
      At line 53 in file Src\GestionSon.s
Comment: Son used once
3 symbols
350 symbols in table
